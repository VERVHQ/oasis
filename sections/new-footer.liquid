<script>
  document.addEventListener('DOMContentLoaded', () => {
    const details = document.querySelectorAll('.footer-nav-col details');
    const isMobile = window.innerWidth < 768;
    
    details.forEach(detail => {
      if (isMobile) {
        detail.removeAttribute('open');
      } else {
        detail.setAttribute('open', '');
      }
    });

    // Handle window resize
    let timeout;
    window.addEventListener('resize', () => {
      clearTimeout(timeout);
      timeout = setTimeout(() => {
        const currentlyMobile = window.innerWidth < 768;
        details.forEach(detail => {
          if (!currentlyMobile) {
             detail.setAttribute('open', '');
          }
        });
      }, 200);
    });
  });
</script>
{% schema %}
 {
   "name": "New Footer",
   "settings": [
     {
       "type": "header",
       "content": "Section Styling"
     },
     {
       "type": "color",
       "id": "bg_color",
       "label": "Background Color",
       "default": "#0a0a0a"
     },
      {
       "type": "image_picker",
       "id": "bg_image",
       "label": "Background Image (Optional)"
     },
     {
       "type": "range",
       "id": "bg_image_opacity",
       "min": 0,
       "max": 100,
       "step": 5,
       "unit": "%",
       "label": "Image Opacity",
       "default": 100
     },
      {
       "type": "range",
       "id": "overlay_opacity",
       "min": 0,
       "max": 100,
       "step": 5,
       "unit": "%",
       "label": "Black Overlay Opacity",
       "default": 0
     },
     {
       "type": "color",
       "id": "divider_color",
       "label": "Divider Color",
       "default": "#333333"
     },
     {
       "type": "range",
       "id": "padding_top",
       "min": 0,
       "max": 200,
       "step": 4,
       "unit": "px",
       "label": "Top Padding",
       "default": 60
     },
     {
       "type": "range",
       "id": "padding_bottom",
       "min": 0,
       "max": 200,
       "step": 4,
       "unit": "px",
       "label": "Bottom Padding",
       "default": 40
     },
     {
       "type": "header",
       "content": "Typography"
     },
     {
       "type": "color",
       "id": "text_color",
       "label": "Text Color",
       "default": "#ffffff"
     },
      {
        "type": "range",
        "id": "heading_font_size_v2",
        "min": 10,
        "max": 40,
        "step": 1,
        "unit": "px",
        "label": "Column Heading Size",
        "default": 16
      },
      {
        "type": "range",
        "id": "link_font_size_v2",
        "min": 10,
        "max": 30,
        "step": 1,
        "unit": "px",
        "label": "Link Text Size",
        "default": 12
      },
     {
       "type": "range",
       "id": "copyright_font_size",
       "min": 10,
       "max": 24,
       "step": 1,
       "unit": "px",
       "label": "Copyright Text Size",
       "default": 12
     },
     {
       "type": "header",
       "content": "Top Content (Logo)"
     },
     {
       "type": "image_picker",
       "id": "logo_image",
       "label": "Brand Logo"
     },
     {
       "type": "range",
       "id": "logo_width",
       "min": 50,
       "max": 400,
       "step": 10,
       "unit": "px",
       "label": "Logo Width",
       "default": 150
     },
     {
       "type": "header",
       "content": "Right Side Badge/Image"
     },
     {
        "type": "image_picker",
        "id": "badge_image",
        "label": "Badge/Certification Image"
     },
     {
        "type": "range",
        "id": "badge_width",
        "min": 20,
        "max": 200,
        "step": 5,
        "unit": "px",
        "label": "Badge Width",
        "default": 80
     },
      {
        "type": "header",
        "content": "Newsletter"
      },
      {
        "type": "text",
        "id": "newsletter_heading",
        "label": "Heading",
        "default": "Sign up to receive 30% off your first order"
      },
      {
        "type": "color",
        "id": "newsletter_bg",
        "label": "Input Background",
        "default": "#1a1a1a"
      },
     {
       "type": "header",
       "content": "Bottom Content"
     },
     {
       "type": "richtext",
       "id": "copyright_text",
       "label": "Copyright Text",
       "default": "<p>2026 Â© Oasis Inc. All Rights Reserved</p>"
     },
     {
       "type": "color",
       "id": "copyright_color",
       "label": "Copyright Color",
       "default": "#888888"
     },
      {
        "type": "header",
        "content": "Social Media Links"
      },
      {
        "type": "range",
        "id": "social_icon_size",
        "min": 16,
        "max": 60,
        "step": 2,
        "unit": "px",
        "label": "Icon Size",
        "default": 24
      },
      {
        "type": "url",
        "id": "social_instagram_link",
        "label": "Instagram Link"
      },
      {
        "type": "image_picker",
        "id": "social_instagram_icon",
        "label": "Instagram Icon (Upload)"
      },
      {
        "type": "url",
        "id": "social_facebook_link",
        "label": "Facebook Link"
      },
      {
        "type": "image_picker",
        "id": "social_facebook_icon",
        "label": "Facebook Icon (Upload)"
      },
      {
        "type": "url",
        "id": "social_youtube_link",
        "label": "YouTube Link"
      },
      {
        "type": "image_picker",
        "id": "social_youtube_icon",
        "label": "YouTube Icon (Upload)"
      },
      {
        "type": "url",
        "id": "social_twitter_link",
        "label": "Twitter/X Link"
      },
      {
        "type": "image_picker",
        "id": "social_twitter_icon",
        "label": "Twitter/X Icon (Upload)"
      },
      {
        "type": "url",
        "id": "social_linkedin_link",
        "label": "LinkedIn Link"
      },
      {
        "type": "image_picker",
        "id": "social_linkedin_icon",
        "label": "LinkedIn Icon (Upload)"
      }
   ],
   "blocks": [
     {
       "type": "footer_column",
       "name": "Navigation Column",
       "limit": 3,
       "settings": [
         {
           "type": "text",
           "id": "heading",
           "label": "Heading",
           "default": "Column Heading"
         },
         {
           "type": "link_list",
           "id": "menu",
           "label": "Menu"
         }
       ]
     }
   ],
   "presets": [
     {
       "name": "New Footer (REORC)",
       "blocks": [
         {
           "type": "footer_column",
           "settings": { "heading": "Solutions" }
         },
         {
           "type": "footer_column",
           "settings": { "heading": "Company" }
         },
         {
           "type": "footer_column",
           "settings": { "heading": "Resources" }
         }
       ]
     }
   ]
 }
{% endschema %}

{%- style -%}
  /* Fix for sticky hero showing through: Ensure footer sits on top */
  #shopify-section-{{ section.id }} {
    position: relative;
    z-index: 5;
    background-color: {{ section.settings.bg_color }};
  }

 .new-footer-section-{{ section.id }} {
   position: relative;
   background-color: {{ section.settings.bg_color }};
   color: {{ section.settings.text_color }};
   overflow: hidden;
   font-family: 'Quicksand', sans-serif;
 }

 .new-footer-bg {
   position: absolute;
   top: 0;
   left: 0;
   width: 100%;
   height: 100%;
   z-index: 0;
   pointer-events: none;
 }

 .new-footer-bg img {
   width: 100%;
   height: 100%;
   object-fit: cover;
   opacity: {{ section.settings.bg_image_opacity | divided_by: 100.0 }};
 }
 
 .new-footer-overlay {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background-color: #000;
    opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    pointer-events: none;
    z-index: 1;
 }

 .new-footer-container {
   position: relative;
   z-index: 2;
   max-width: 1400px;
   margin: 0 auto;
   padding: 0 20px;
   padding-top: {{ section.settings.padding_top }}px;
   padding-bottom: {{ section.settings.padding_bottom }}px;
 }

 /* --- TOP BAR LAYOUT --- */
 .footer-top-bar {
   display: flex;
   flex-direction: column;
   gap: 30px;
   padding-bottom: 40px;
   border-bottom: 1px solid {{ section.settings.divider_color }};
   margin-bottom: 40px;
 }

 @media screen and (min-width: 768px) {
   .footer-top-bar {
     flex-direction: row;
     justify-content: space-between;
     align-items: center; /* Vertically align logo and form */
   }
 }

 .footer-logo-wrapper {
   flex-shrink: 0;
 }

 .footer-top-newsletter {
   width: 100%;
   max-width: 500px;
 }

 .footer-newsletter-heading {
   font-size: 20px; /* Adjusted size for top bar */
   font-weight: 700;
   margin-bottom: 16px;
   line-height: 1.2;
   text-align: left;
 }
 
 @media screen and (min-width: 768px) {
    .footer-newsletter-heading {
        text-align: left;
    }
 }

 .newsletter-form {
   max-width: 100%;
   margin-bottom: 0;
   position: relative;
 }

 .newsletter-input-wrapper {
   position: relative;
   display: flex;
   align-items: center;
   background-color: {{ section.settings.newsletter_bg }};
   border-radius: 8px;
   padding: 5px;
 }

 .newsletter-input {
   width: 100%;
   background: transparent;
   border: none;
   color: {{ section.settings.text_color }};
   padding: 12px 16px;
   font-size: 14px;
 }
 
 .newsletter-input:focus {
   outline: none;
 }
 .newsletter-input::placeholder {
   color: rgba(255,255,255,0.5);
 }

 .newsletter-submit {
   background: #ffffff;
   border: none;
   border-radius: 50%;
   width: 36px;
   height: 36px;
   display: flex;
   align-items: center;
   justify-content: center;
   cursor: pointer;
   color: #000;
   transition: transform 0.2s ease;
   flex-shrink: 0;
   margin-right: 4px;
 }
 
 .newsletter-submit:hover {
   transform: scale(1.05);
 }


 /* --- MAIN GRID (Links) --- */
 .footer-nav-grid {
   display: grid;
   grid-template-columns: repeat(2, 1fr);
   gap: 40px;
   margin-bottom: 40px;
   width: 100%;
 }
 
 /* Use 4 columns on desktop for links + badge */
 @media screen and (min-width: 1024px) {
   .footer-nav-grid {
     grid-template-columns: repeat(4, 1fr);
   }
 }

 .footer-nav-grid {
   display: grid;
   grid-template-columns: repeat(2, 1fr);
   gap: 40px;
 }

 @media screen and (min-width: 768px) {
   .footer-nav-grid {
     grid-template-columns: repeat(3, 1fr);
   }
 }
 
 /* Reuse existing menu styles */


  .footer-column-heading {
    font-size: {{ section.settings.heading_font_size_v2 }}px;
    font-weight: 600;
    margin-bottom: 24px;
    color: {{ section.settings.text_color }};
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    list-style: none;
    user-select: none;
  }

  .footer-column-heading::-webkit-details-marker {
    display: none;
  }

  .footer-column-heading .icon-caret {
    width: 12px;
    height: 12px;
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    opacity: 0.6;
  }

  details[open] .footer-column-heading .icon-caret {
    transform: rotate(180deg);
  }

  .footer-menu {
    list-style: none;
    padding: 0;
    margin: 0;
    overflow: hidden;
    transition: all 0.3s ease;
  }

  /* Desktop layout tweaks */
  @media screen and (min-width: 768px) {
    .footer-column-heading {
      margin-bottom: 20px;
    }
  }

  .footer-menu li {
   margin-bottom: 14px;
 }

  .footer-menu a {
    text-decoration: none;
    color: {{ section.settings.text_color }};
    font-size: {{ section.settings.link_font_size_v2 }}px;
    opacity: 0.7;
    transition: opacity 0.2s;
  }

 .footer-menu a:hover {
   opacity: 1;
 }
 
 .footer-badge-column {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
 }
 
 @media screen and (min-width: 1024px) {
    .footer-badge-column {
        align-items: flex-end; /* Right align on desktop */
    }
 }

 .footer-badge img {
    width: {{ section.settings.badge_width }}px;
    height: auto;
 }


 /* --- ROW 3: Bottom --- */
 .footer-bottom-bar {
   display: flex;
   flex-direction: column;
   gap: 20px;
   align-items: flex-start;
 }

 @media screen and (min-width: 768px) {
   .footer-bottom-bar {
     flex-direction: row;
     justify-content: space-between;
     align-items: center;
   }
 }

 .footer-copyright {
   color: {{ section.settings.copyright_color }};
   font-size: {{ section.settings.copyright_font_size }}px;
 }
 
 .footer-copyright p { margin: 0; }

  .footer-social-icons {
    display: flex;
    gap: 16px;
    margin-top: 24px;
    justify-content: flex-start;
  }

  @media screen and (min-width: 768px) {
    .footer-social-icons {
      justify-content: flex-start;
    }
  }

  .footer-social-link {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), filter 0.3s ease;
  }
  
  .footer-social-link:hover {
     transform: translateY(-5px) scale(1.1);
     filter: brightness(1.2);
  }

  .footer-social-link img {
    width: {{ section.settings.social_icon_size }}px;
    height: {{ section.settings.social_icon_size }}px;
    object-fit: contain;
    display: block;
  }

  .footer-social-link svg {
    width: {{ section.settings.social_icon_size }}px;
    height: {{ section.settings.social_icon_size }}px;
    color: {{ section.settings.text_color }};
  }

{%- endstyle -%}

<div class="new-footer-section-{{ section.id }}">
 
 <div class="new-footer-bg">
    {%- if section.settings.bg_image != blank -%}
      {{ section.settings.bg_image | image_url: width: 2000 | image_tag: loading: 'lazy' }}
    {%- endif -%}
 </div>
 
 <div class="new-footer-overlay"></div>

 <div class="new-footer-container">
   
   <!-- Top Row: Logo & Newsletter -->
   <div class="footer-top-bar">
     <div class="footer-logo-wrapper">
       {%- if section.settings.logo_image != blank -%}
         {{ section.settings.logo_image | image_url: width: section.settings.logo_width | image_tag: loading: 'lazy' }}
       {%- else -%}
         <h2 style="margin:0; font-size: 24px;">{{ shop.name }}</h2>
       {%- endif -%}
     </div>

     <div class="footer-top-newsletter">
        {%- if section.settings.newsletter_heading != blank -%}
           <div class="footer-newsletter-heading">{{ section.settings.newsletter_heading }}</div>
        {%- endif -%}

         <div class="newsletter-form">
           {% form 'customer', class: 'newsletter-form' %}
             <input type="hidden" name="contact[tags]" value="newsletter">
             <div class="newsletter-input-wrapper">
               <input
                 id="NewsletterForm--{{ section.id }}"
                 type="email"
                 name="contact[email]"
                 class="newsletter-input"
                 value="{{ form.email }}"
                 aria-required="true"
                 autocorrect="off"
                 autocapitalize="off"
                 autocomplete="email"
                 {% if form.errors %}
                   autofocus
                   aria-invalid="true"
                   aria-describedby="Newsletter-error--{{ section.id }}"
                 {% elsif form.posted_successfully? %}
                   aria-describedby="Newsletter-success--{{ section.id }}"
                 {% endif %}
                 placeholder="Enter your email"
                 required
               >
               <button type="submit" class="newsletter-submit" name="commit" id="Subscribe" aria-label="Subscribe">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6.66669 4L10.6667 8L6.66669 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
               </button>
             </div>
             {%- if form.errors -%}
               <small class="newsletter-form__message form__message" id="Newsletter-error--{{ section.id }}">{{ form.errors.translated_fields['email'] | capitalize }} {{ form.errors.messages['email'] }}</small>
             {%- endif -%}
             {%- if form.posted_successfully? -%}
               <small class="newsletter-form__message form__message form__message--success" id="Newsletter-success--{{ section.id }}" tabindex="-1" autofocus>Thanks for subscribing!</small>
             {%- endif -%}
           {% endform %}
         </div>

         <!-- Custom Social Icons (User Uploaded) -->
         <div class="footer-social-icons">
            {%- if section.settings.social_instagram_icon != blank -%}
              <a href="{{ section.settings.social_instagram_link }}" class="footer-social-link" aria-label="Instagram">
                {{ section.settings.social_instagram_icon | image_url: width: 100 | image_tag: loading: 'lazy' }}
              </a>
            {%- endif -%}
            {%- if section.settings.social_facebook_icon != blank -%}
              <a href="{{ section.settings.social_facebook_link }}" class="footer-social-link" aria-label="Facebook">
                {{ section.settings.social_facebook_icon | image_url: width: 100 | image_tag: loading: 'lazy' }}
              </a>
            {%- endif -%}
            {%- if section.settings.social_youtube_icon != blank -%}
              <a href="{{ section.settings.social_youtube_link }}" class="footer-social-link" aria-label="YouTube">
                {{ section.settings.social_youtube_icon | image_url: width: 100 | image_tag: loading: 'lazy' }}
              </a>
            {%- endif -%}
            {%- if section.settings.social_twitter_icon != blank -%}
              <a href="{{ section.settings.social_twitter_link }}" class="footer-social-link" aria-label="Twitter">
                {{ section.settings.social_twitter_icon | image_url: width: 100 | image_tag: loading: 'lazy' }}
              </a>
            {%- endif -%}
            {%- if section.settings.social_linkedin_icon != blank -%}
              <a href="{{ section.settings.social_linkedin_link }}" class="footer-social-link" aria-label="LinkedIn">
                {{ section.settings.social_linkedin_icon | image_url: width: 100 | image_tag: loading: 'lazy' }}
              </a>
            {%- endif -%}
         </div>
     </div>
   </div>

   <!-- Middle Row: Links Grid (Full Width) -->
   <div class="footer-nav-grid">
     {%- for block in section.blocks -%}
       <div class="footer-nav-col">
         <details id="Details-{{ block.id }}-{{ section.id }}">
           <summary class="footer-column-heading">
             <span>{{ block.settings.heading | escape }}</span>
             <svg aria-hidden="true" focusable="false" class="icon icon-caret" viewBox="0 0 10 6">
               <path fill-rule="evenodd" clip-rule="evenodd" d="M9.354.646a.5.5 0 00-.708 0L5 4.293 1.354.646a.5.5 0 00-.708.708l4 4a.5.5 0 00.708 0l4-4a.5.5 0 000-.708z" fill="currentColor">
             </svg>
           </summary>
           
           {%- if block.settings.menu != blank -%}
             <ul class="footer-menu">
               {%- for link in linklists[block.settings.menu].links -%}
                 <li><a href="{{ link.url }}">{{ link.title }}</a></li>
               {%- endfor -%}
             </ul>
           {%- endif -%}
         </details>
       </div>
     {%- endfor -%}
     
     <!-- Badge in Grid (Rightmost) -->
      <div class="footer-badge-column">
         {%- if section.settings.badge_image != blank -%}
             <div class="footer-badge">
                 {{ section.settings.badge_image | image_url: width: section.settings.badge_width | image_tag: loading: 'lazy' }}
             </div>
         {%- endif -%}
       </div>
   </div>

    <div class="footer-bottom-bar">
      <div class="footer-copyright">
        {{ section.settings.copyright_text }}
      </div>
    </div>

 </div>
</div>
